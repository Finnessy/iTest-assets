<?xml version="1.0"?>
<testCase version="5.4.0.4f90e5a">
    <general>
        <sessionClass includeTestCase="true" sessionType="Cisco_ASR5K_ssh.ffsp"/>
    </general>
    <procedures>
        <item name="main">
            <steps>
                <item guid="66e862a9-aa95-4c01-9c93-3b1f60e12504" action="comment">
                    <command>
                        <body>ASR QC Lib</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                    <useFieldsInCommand>false</useFieldsInCommand>
                </item>
            </steps>
        </item>
        <item name="clearSubscriberInfo" isPublic="true" isVBlock="true">
            <steps>
                <item guid="13be0e66-6cdc-4101-9a83-82021446ed4a" action="command" session="$session">
                    <command>
                        <body>clear sub imsi $IMSI</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties"/>
                </item>
            </steps>
            <multilineDescription>Clear the subcriber info for the specified IMSI</multilineDescription>
            <arguments>
                <item name="IMSI">
                    <description>The IMSI of the UE to clear</description>
                    <isMandatory>true</isMandatory>
                </item>
            </arguments>
        </item>
        <item name="disableLogging" isPublic="true" isVBlock="true">
            <description>Disable debug logging</description>
            <steps>
                <item guid="a419d696-91f6-4dbf-837a-682229675e48" action="command" session="$session">
                    <command>
                        <body>q</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties"/>
                </item>
                <item guid="969956a5-a74c-4822-b1ea-754a7fd68cea" action="command" session="$session">
                    <command>
                        <body>no logging active</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties"/>
                </item>
            </steps>
            <author>Malcom Terry</author>
            <multilineDescription>Disable logging on the ASR</multilineDescription>
            <response>{&quot;success&quot;:&quot;1&quot;}</response>
        </item>
        <item name="enableLogging" isPublic="true" isVBlock="true">
            <description>Enable debug logging</description>
            <steps>
                <item guid="2864443d-baa1-480c-8064-f212ad026dff" action="command" session="$session">
                    <command>
                        <body>logging filter active facility epdg level debug 
logging filter active facility eap-sta-s6a-s13-s6b-diameter level debug
logging filter active facility eap-ipsec level debug
logging filter active facility ikev2 level debug
logging filter active facility ipsec level debug
logging filter active facility dcardmgr level debug
logging filter active facility npumgr level debug
logging filter active facility imsimgr level debug
logging filter active facility hamgr level debug
logging filter active facility mobile-ipv6 level debug
logging filter active facility diabase level debug
logging filter active facility diameter-auth level debug
logging filter active facility aaamgr level debug
logging filter active facility aaa-client level debug
logging filter active facility diameter level debug
logging filter active facility egtpc level debug
logging filter active facility egtpu level debug
logging filter active facility egtpmgr level debug
logging filter active facility mobile-ipv6 level debug
logging filter active facility mobile-ip-data level debug
logging filter active facility ipsgmgr level debug
logging filter active facility sessmg level debug</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties">
                        <completionProperties>
                            <promptExtraction inherit="false">ANYWHERE</promptExtraction>
                        </completionProperties>
                    </applicationProperties>
                </item>
                <item guid="16c1a463-e129-481e-91b7-f9955bb78a3d" action="command" session="$session">
                    <command>
                        <body>logging filter active facility s1ap level debug</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties">
                        <completionProperties>
                            <promptExtraction inherit="false">ANYWHERE</promptExtraction>
                        </completionProperties>
                    </applicationProperties>
                </item>
                <item guid="55076450-1316-4c65-8317-7d62f43cb7ce" action="command" session="$session">
                    <command>
                        <body>logging filter active facility mme-app level debug</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties">
                        <completionProperties>
                            <promptExtraction inherit="false">ANYWHERE</promptExtraction>
                        </completionProperties>
                    </applicationProperties>
                </item>
                <item guid="aed44405-3f5f-4c3b-b7a6-e38dd07f4a1c" action="command" session="$session">
                    <command>
                        <body>logging filter active facility mme-embms level debug</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties">
                        <completionProperties>
                            <promptExtraction inherit="false">ANYWHERE</promptExtraction>
                        </completionProperties>
                    </applicationProperties>
                </item>
                <item guid="77a83412-8afe-4e88-aa5a-98935050fc40" action="command" session="$session">
                    <command>
                        <body>logging filter active facility mme-misc level debug</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties">
                        <completionProperties>
                            <promptExtraction inherit="false">ANYWHERE</promptExtraction>
                        </completionProperties>
                    </applicationProperties>
                </item>
                <item guid="ee4c3b81-6ae9-4fdb-8a63-d270a61fc515" action="command" session="$session">
                    <command>
                        <body>logging filter active facility mmedemux level debug</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties">
                        <completionProperties>
                            <promptExtraction inherit="false">ANYWHERE</promptExtraction>
                        </completionProperties>
                    </applicationProperties>
                </item>
                <item guid="1f3e4606-5a8e-4c7e-980a-32d575599a99" action="command" session="$session">
                    <command>
                        <body>logging filter active facility mmemgr level debug</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties">
                        <completionProperties>
                            <promptExtraction inherit="false">ANYWHERE</promptExtraction>
                        </completionProperties>
                    </applicationProperties>
                </item>
                <item guid="02cfd23d-3b9d-4cc9-af46-d7877b54d768" action="command" session="$session">
                    <command>
                        <body>logging filter active facility sgw level debug</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties">
                        <completionProperties>
                            <promptExtraction inherit="false">ANYWHERE</promptExtraction>
                        </completionProperties>
                    </applicationProperties>
                </item>
                <item guid="80eb2fa1-b356-48f5-b082-63346a727c39" action="command" session="$session">
                    <command>
                        <body>logging filter active facility pgw level debug</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties">
                        <completionProperties>
                            <promptExtraction inherit="false">ANYWHERE</promptExtraction>
                        </completionProperties>
                    </applicationProperties>
                </item>
                <item guid="183f1a97-8822-49c7-89e0-88de9e5a7687" action="command" session="$session">
                    <command>
                        <body>logging filter active facility egtpc level debug</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties">
                        <completionProperties>
                            <promptExtraction inherit="false">ANYWHERE</promptExtraction>
                        </completionProperties>
                    </applicationProperties>
                </item>
                <item guid="dbaee834-c76b-424a-b879-cdfeefc7c1c5" action="command" session="$session">
                    <command>
                        <body>logging filter active facility egtpmgr level debug</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties">
                        <completionProperties>
                            <promptExtraction inherit="false">ANYWHERE</promptExtraction>
                        </completionProperties>
                    </applicationProperties>
                </item>
                <item guid="1a84a095-d50e-40f6-85e1-c2f113a5af1b" action="command" session="$session">
                    <command>
                        <body>logging filter active facility diamproxy level debug</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties">
                        <completionProperties>
                            <promptExtraction inherit="false">ANYWHERE</promptExtraction>
                        </completionProperties>
                    </applicationProperties>
                </item>
                <item guid="b08ebcec-1bc7-4035-8517-05852c5bce04" action="command" session="$session">
                    <command>
                        <body>logging filter active facility diabase level debug</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties">
                        <completionProperties>
                            <promptExtraction inherit="false">ANYWHERE</promptExtraction>
                        </completionProperties>
                    </applicationProperties>
                </item>
                <item guid="bc812acd-1566-4ed3-a6fe-4571a852cd62" action="command" session="$session">
                    <command>
                        <body>logging filter active facility eap-sta-s6a-s13-s6b-diameter level debug</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties">
                        <completionProperties>
                            <promptExtraction inherit="false">ANYWHERE</promptExtraction>
                        </completionProperties>
                    </applicationProperties>
                </item>
                <item guid="2fa86e93-842a-484b-9640-0d62b601bdb4" action="command" session="$session">
                    <command>
                        <body>logging filter active facility diameter-ecs level debug</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties">
                        <completionProperties>
                            <promptExtraction inherit="false">ANYWHERE</promptExtraction>
                        </completionProperties>
                    </applicationProperties>
                </item>
                <item guid="37eb8ec6-4c6a-423b-8c71-f06b919ad8ac" action="command" session="$session">
                    <command>
                        <body>logging filter active facility diameter level debug</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties">
                        <completionProperties>
                            <promptExtraction inherit="false">ANYWHERE</promptExtraction>
                        </completionProperties>
                    </applicationProperties>
                </item>
                <item guid="d1888083-6a17-45df-8429-b01957f5346e" action="command" session="$session">
                    <command>
                        <body>logging filter active facility vpn level debug</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties">
                        <completionProperties>
                            <promptExtraction inherit="false">ANYWHERE</promptExtraction>
                        </completionProperties>
                    </applicationProperties>
                </item>
                <item guid="76a5c0f0-7060-4a02-a9f9-ebf01cae20f9" action="command" session="$session">
                    <command>
                        <body>logging active</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties">
                        <completionProperties>
                            <completeWhen inherit="false">AUTO_OR_IDLE</completeWhen>
                            <promptExtraction inherit="false">ANYWHERE</promptExtraction>
                        </completionProperties>
                    </applicationProperties>
                </item>
            </steps>
            <author>Malcom Terry</author>
            <multilineDescription>Enable the ASR logging</multilineDescription>
            <arguments>
                <item name="captureTime">
                    <description>The amount of time to capture the logs</description>
                    <defaultValue>180</defaultValue>
                </item>
            </arguments>
            <response>{&quot;success&quot;:&quot;1&quot;}</response>
        </item>
        <item name="getSystemTime" isPublic="true" isVBlock="true">
            <responseMap>project://d_Cisco_ASR5K/response_maps/JsonBlockToQueries.ffrm</responseMap>
            <steps>
                <item guid="49bc3a3b-946c-4509-8d5c-51871f5bc09a" action="command" session="$session">
                    <command>
                        <body>show system</body>
                    </command>
                    <postProcessing>
                        <storeResponseAt>myResponse</storeResponseAt>
                    </postProcessing>
                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties"/>
                    <responseFilterList inherit="false">
                        <item name="TimeStamp" patternType="REGEX" filterAction="INC_LINES_CONTAINING">
                            <pattern>\\w+\\s+\\w+\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+\\w+\\s+\\d+</pattern>
                        </item>
                    </responseFilterList>
                </item>
                <item guid="76b4b523-0328-4fb5-8bf7-355aaa2638ee" action="eval">
                    <command>
                        <body>set sysTime [clock format [clock scan [response myResponse]] -format &quot;%Y:%m:%d:%H:%M:%S&quot;]</body>
                    </command>
                    <postProcessing>
                        <analysisRules>
                            <item>
                                <extractorInfo extractorType="regex">
                                    <extractorProperties type="com.fnfr.svt.mapping.regex.extractors.RegexExtractorPropertyGroup">
                                        <regex>(\\S+)</regex>
                                    </extractorProperties>
                                </extractorInfo>
                                <processorInfo ruleType="store">
                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                        <query>[return sysTime]</query>
                                    </ruleProperties>
                                </processorInfo>
                            </item>
                        </analysisRules>
                    </postProcessing>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                    <useFieldsInCommand>false</useFieldsInCommand>
                </item>
            </steps>
            <multilineDescription>Get the system time from the ASR5K in the format: YYYY:MM:DD:hh:mm:ss

Return: JSON Block
sysTime: either the system time or &quot;invalid&quot;</multilineDescription>
            <response>{&quot;sysTime&quot;:&quot;invalid&quot;}</response>
        </item>
        <item name="getTimestamp" isPublic="true" isVBlock="true">
            <description>Get clock value and return timestamp</description>
            <steps>
                <item guid="5e3b057a-6046-43ad-a999-0cc5d4a9305d" action="command" session="$session">
                    <command>
                        <body>show clock</body>
                    </command>
                    <postProcessing>
                        <storeResponseAt>response</storeResponseAt>
                        <storeResponseText>true</storeResponseText>
                    </postProcessing>
                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties"/>
                    <responseFilterList inherit="false"/>
                </item>
                <item guid="ca050caf-97f7-449e-9d86-65f3e551cda5" action="eval">
                    <command>
                        <body>set date [lindex [split $response \\n] 0]</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                    <useFieldsInCommand>false</useFieldsInCommand>
                </item>
                <item guid="3d7fb65a-dc2b-4756-94ed-213acd7ce325" action="eval">
                    <command>
                        <body>set timestamp [clock format [clock scan $date] -format &quot;%Y:%m:%d:%H:%M:%S&quot;]</body>
                    </command>
                    <postProcessing>
                        <analysisRules>
                            <item>
                                <extractorInfo extractorType="query">
                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                        <query>group1()</query>
                                    </extractorProperties>
                                </extractorInfo>
                                <processorInfo ruleType="store">
                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                        <query>[return timestamp]</query>
                                    </ruleProperties>
                                </processorInfo>
                            </item>
                        </analysisRules>
                    </postProcessing>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                    <useFieldsInCommand>false</useFieldsInCommand>
                </item>
            </steps>
            <author>Malcom Terry</author>
            <multilineDescription>Show the clock and return timestamp in YYYY:MM:DD:hh:mm:ss format</multilineDescription>
            <response>{&quot;timestamp&quot;:&quot;YYYY:MM:DD:HH:mm:ss&quot;}</response>
        </item>
        <item name="isSubscriberActive" isPublic="true" isVBlock="true">
            <responseMap>project://d_Cisco_ASR5K/response_maps/JsonBlockToQueries.ffrm</responseMap>
            <steps>
                <item guid="b6ef8d66-42c2-42bf-979d-2f37efe4300e" action="command" session="$session" normalOffset="45.707" estimatedStepExecutionTime="0.926">
                    <command>
                        <body>show subscribers all</body>
                    </command>
                    <postProcessing>
                        <analysisRules>
                            <item>
                                <extractorInfo extractorType="query">
                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup" declareNoMatchIssue="false">
                                        <query sub="true">CALLID_by_IMSI(&apos;$IMSI&apos;)</query>
                                    </extractorProperties>
                                </extractorInfo>
                                <processorInfo ruleType="store">
                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                        <query>[return active]</query>
                                    </ruleProperties>
                                </processorInfo>
                            </item>
                            <item>
                                <extractorInfo extractorType="query">
                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup" declareNoMatchIssue="false">
                                        <query sub="true">IP_by_IMSI(&apos;$IMSI&apos;)</query>
                                    </extractorProperties>
                                </extractorInfo>
                                <processorInfo ruleType="store">
                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                        <query>[return IPAddress]</query>
                                    </ruleProperties>
                                </processorInfo>
                            </item>
                        </analysisRules>
                    </postProcessing>
                    <eventHandlers>
                        <item name="OnQueryExtractorInvalidQuery"/>
                    </eventHandlers>
                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties">
                        <completionProperties expectedIdleTime="0.342" expectedIdleTime.inherit="false"/>
                    </applicationProperties>
                </item>
            </steps>
            <multilineDescription>Based on the IMSI, see if the subscriber is in the active list

Return Values: JSON Block

active: nonzero - active; 0 - not active</multilineDescription>
            <arguments>
                <item name="IMSI">
                    <description>The IMSI of the desired subscriber</description>
                    <isMandatory>true</isMandatory>
                </item>
            </arguments>
            <response>{&quot;active&quot;:&quot;0&quot;,&quot;IPAddress&quot;:&quot;0&quot;}</response>
        </item>
        <item name="configure_Monitor_Protocol" isPublic="true" isVBlock="true">
            <steps>
                <item guid="a5215df2-ed86-4ee3-ae4e-7ba4222386bc" action="command" session="$session">
                    <command>
                        <body>monitor protocol</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties"/>
                </item>
                <item guid="24d0f10c-6def-4fac-bc71-b489963f4ce1" action="comment">
                    <command>
                        <body>Set the verbosity level if needed</body>
                    </command>
                    <nestedSteps>
                        <item guid="521ed2e8-e5ce-4208-8753-832c84305282" action="for">
                            <command>
                                <body>{set i 2} {$i &lt;= $verbosity_level} {incr i}</body>
                            </command>
                            <nestedSteps>
                                <item guid="76af95f5-7973-4cc3-b5bc-f8ca629434e8" action="command" session="$session" normalOffset="0.358" useResponseMapLibraryApplicability="false">
                                    <command>
                                        <body>+</body>
                                    </command>
                                    <eventHandlers>
                                        <item name="OnPromptNotFoundTimeout">
                                            <item actionId="DeclareExecutionIssue">
                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                    <message>Step timed out waiting for the prompt</message>
                                                </actionProperties>
                                            </item>
                                            <item actionId="FailTest">
                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                            </item>
                                        </item>
                                    </eventHandlers>
                                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties">
                                        <promptProperties>
                                            <stepPrompts>
                                                <item name="Select" MatchMethod="REGULAR_EXPRESSION">
                                                    <Content>\\s+Select:</Content>
                                                </item>
                                                <item name="MonSubMenu" MatchMethod="WILDCARD" TypeOfPrompt="PASSWORD">
                                                    <Content>*(B)egin Protocol Decoding,*</Content>
                                                </item>
                                            </stepPrompts>
                                            <alsoUseSessionPrompts inherit="false">false</alsoUseSessionPrompts>
                                        </promptProperties>
                                        <completionProperties>
                                            <idleChannel inherit="false">200</idleChannel>
                                            <completeWhen inherit="false">AUTO_OR_IDLE</completeWhen>
                                            <promptExtraction inherit="false">ANYWHERE</promptExtraction>
                                            <screenMode inherit="false" defaultValue=""/>
                                        </completionProperties>
                                    </applicationProperties>
                                    <responseMap>project://d_Cisco_ASR5K/response_maps/monitor_protocol.ffrm</responseMap>
                                    <useResponseMapLibraryFromSession>false</useResponseMapLibraryFromSession>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                            <useFieldsInCommand>false</useFieldsInCommand>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                    <useFieldsInCommand>false</useFieldsInCommand>
                </item>
                <item guid="22b7e081-519d-479a-a620-221f50878039" action="comment">
                    <command>
                        <body>Enable each protocol</body>
                    </command>
                    <nestedSteps>
                        <item guid="56a80c1e-a18c-4981-be48-882a6c92143c" action="foreach">
                            <command>
                                <body>protocol $protocol_layers</body>
                            </command>
                            <nestedSteps>
                                <item guid="e3c19b97-24c1-4305-9a83-5f2f42082c76" action="command" session="$session" normalOffset="0.358" useResponseMapLibraryApplicability="false">
                                    <command>
                                        <body>$protocol</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties">
                                        <promptProperties>
                                            <stepPrompts>
                                                <item name="monProtocol" MatchMethod="WILDCARD">
                                                    <Content>*(B)egin Protocol Decoding,*</Content>
                                                </item>
                                                <item name="Proceed" MatchMethod="WILDCARD">
                                                    <Content>Proceed?*</Content>
                                                </item>
                                            </stepPrompts>
                                        </promptProperties>
                                        <completionProperties>
                                            <idleChannel inherit="false">200</idleChannel>
                                            <completeWhen inherit="false">AUTO_OR_IDLE</completeWhen>
                                            <promptExtraction inherit="false">ANYWHERE</promptExtraction>
                                            <completionTime inherit="false">1</completionTime>
                                            <screenMode inherit="false" defaultValue=""/>
                                        </completionProperties>
                                    </applicationProperties>
                                    <useResponseMapLibraryFromSession>false</useResponseMapLibraryFromSession>
                                    <performResponseMapping>false</performResponseMapping>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                            <useFieldsInCommand>false</useFieldsInCommand>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                    <useFieldsInCommand>false</useFieldsInCommand>
                </item>
                <item guid="c8b0bd9a-52ff-4e3f-9264-c476362ec1e5" action="comment">
                    <command>
                        <body>Monitor Subscriber is finished configuring</body>
                    </command>
                    <nestedSteps>
                        <item guid="d3eb39ed-4a47-4d04-9b8c-99b2e8ed0699" action="signal">
                            <command>
                                <body>monProtocolConfigured</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                    <useFieldsInCommand>false</useFieldsInCommand>
                </item>
            </steps>
            <multilineDescription>Start a monitor protocol session 

NOTE: Monitor Protocol Never returns so this should be started in a thread and signalled by the main test case or a Fake Prompt should be passed to this procedure.

Return Value: JSON Block
status: 1 - success; 0 - failure</multilineDescription>
            <arguments>
                <item name="protocol_layers">
                    <defaultValue>81 82 74 70 29 </defaultValue>
                </item>
                <item name="fakePrompt">
                    <description>If passed, iTest will look to terminate the Mon Sub when this text is found</description>
                </item>
                <item name="captureTime">
                    <description>The time to capture monSub in seconds</description>
                    <defaultValue>120</defaultValue>
                </item>
                <item name="verbosity_level">
                    <description>The verbosity level to select: iTest will hit theh &quot;+&quot; the specified number of times</description>
                    <defaultValue>3</defaultValue>
                </item>
            </arguments>
            <response>{&quot;status&quot;:&quot;1&quot;}</response>
        </item>
        <item name="configure_Monitor_Subscriber" isPublic="true" isVBlock="true">
            <responseMap>project://d_Cisco_ASR5K/response_maps/JsonBlockToQueries.ffrm</responseMap>
            <steps>
                <item guid="2417fa92-0f9c-49b6-8692-ef471c45d179" action="comment">
                    <command>
                        <body>Filter on IMEI</body>
                    </command>
                    <nestedSteps>
                        <item guid="20522fd2-5e65-4efd-81c0-db80d287fbdd" action="if">
                            <command>
                                <body>$IMEI ne &quot;&quot;</body>
                            </command>
                            <nestedSteps>
                                <item guid="8352a295-53e8-42d0-b301-b62309cce651" action="then">
                                    <nestedSteps>
                                        <item guid="2c7875e3-a9d3-4582-878e-1ae7e96a3c0d" action="command" session="$session" normalOffset="78.252" estimatedStepExecutionTime="0.209">
                                            <command>
                                                <body>monitor subscriber imei $IMEI</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties">
                                                <completionProperties>
                                                    <completeWhen inherit="false">TIMED</completeWhen>
                                                    <completionTime inherit="false">5</completionTime>
                                                    <screenMode inherit="false">true</screenMode>
                                                </completionProperties>
                                            </applicationProperties>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                    <useFieldsInCommand>false</useFieldsInCommand>
                                </item>
                                <item guid="2e8aed86-b2f1-44d7-9fb4-8140a2b1e5c4" action="else">
                                    <nestedSteps>
                                        <item guid="737d5e70-1365-4b5c-ada6-aa91a17f67c1" action="comment">
                                            <command>
                                                <body>Filter on IMSI - command for IMSI is &quot;a&quot;</body>
                                            </command>
                                            <nestedSteps>
                                                <item guid="e41a28cd-7e23-4d9c-aa9d-42ddb6b6a332" action="if">
                                                    <command>
                                                        <body>$IMSI ne &quot;&quot;</body>
                                                    </command>
                                                    <nestedSteps>
                                                        <item guid="482e773b-59e7-4145-92b6-c810b7bc77f7" action="then">
                                                            <nestedSteps>
                                                                <item guid="c9ae474d-be3a-4642-803b-0e0ee2e2be46" action="command" session="$session" normalOffset="78.252" estimatedStepExecutionTime="0.209">
                                                                    <command>
                                                                        <body>monitor subscriber imsi $IMSI</body>
                                                                    </command>
                                                                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties">
                                                                        <completionProperties>
                                                                            <completeWhen inherit="false">TIMED</completeWhen>
                                                                            <completionTime inherit="false">5</completionTime>
                                                                            <screenMode inherit="false">true</screenMode>
                                                                        </completionProperties>
                                                                    </applicationProperties>
                                                                </item>
                                                            </nestedSteps>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            <useFieldsInCommand>false</useFieldsInCommand>
                                                        </item>
                                                        <item guid="1b232410-28c6-4b0a-8b5a-46914fbed232" action="else">
                                                            <nestedSteps>
                                                                <item guid="f49927ab-c2e2-4ded-9b64-be8ca985dd1c" action="eval">
                                                                    <command>
                                                                        <body>puts 0</body>
                                                                    </command>
                                                                    <postProcessing>
                                                                        <analysisRules>
                                                                            <item>
                                                                                <extractorInfo extractorType="regex">
                                                                                    <extractorProperties type="com.fnfr.svt.mapping.regex.extractors.RegexExtractorPropertyGroup">
                                                                                        <regex>(\\S+)</regex>
                                                                                    </extractorProperties>
                                                                                </extractorInfo>
                                                                                <processorInfo ruleType="store">
                                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                                        <query>[return success]</query>
                                                                                    </ruleProperties>
                                                                                </processorInfo>
                                                                            </item>
                                                                            <item>
                                                                                <extractorInfo extractorType="none">
                                                                                    <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                                                                </extractorInfo>
                                                                                <processorInfo ruleType="assert">
                                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                                        <expression>1</expression>
                                                                                        <actionsWhenTrue>
                                                                                            <item actionId="DeclareExecutionIssue">
                                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="Information">
                                                                                                    <message>No IMSI or IMEI passed to monitor subscriber</message>
                                                                                                </actionProperties>
                                                                                            </item>
                                                                                            <item actionId="ExitProcedure">
                                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExitProcedurePropertyGroup"/>
                                                                                            </item>
                                                                                        </actionsWhenTrue>
                                                                                    </ruleProperties>
                                                                                </processorInfo>
                                                                            </item>
                                                                        </analysisRules>
                                                                    </postProcessing>
                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    <useFieldsInCommand>false</useFieldsInCommand>
                                                                </item>
                                                            </nestedSteps>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            <useFieldsInCommand>false</useFieldsInCommand>
                                                        </item>
                                                    </nestedSteps>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    <useFieldsInCommand>false</useFieldsInCommand>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                            <useFieldsInCommand>false</useFieldsInCommand>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                    <useFieldsInCommand>false</useFieldsInCommand>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                            <useFieldsInCommand>false</useFieldsInCommand>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                    <useFieldsInCommand>false</useFieldsInCommand>
                </item>
                <item guid="406fd995-b2d1-46ee-87d2-5497406eb642" action="comment">
                    <command>
                        <body>Set the verbosity level if needed</body>
                    </command>
                    <nestedSteps>
                        <item guid="96ffa596-8668-49ea-8ebd-58270582a5f9" action="while">
                            <command>
                                <body>1</body>
                            </command>
                            <nestedSteps>
                                <item guid="2bbe0878-1926-4e8e-8c0c-9e2fc1fec52a" action="command" session="$session" useResponseMapLibraryApplicability="false">
                                    <command>
                                        <body>\\n</body>
                                    </command>
                                    <postProcessing>
                                        <analysisRules>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup" declareNoMatchIssue="false">
                                                        <query>Verbosity_Level()</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="assert">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                        <expression>$value == $verbosity_level</expression>
                                                        <actionsWhenTrue>
                                                            <item actionId="Break">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                            <item actionId="PassTestIfNotAlreadyFailed">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                        </actionsWhenTrue>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup" declareNoMatchIssue="false">
                                                        <query>count(Verbosity_Level())</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="assert">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                        <expression>$value == 0</expression>
                                                        <actionsWhenTrue>
                                                            <item actionId="RepeatStep">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.RepeatStepPropertyGroup"/>
                                                            </item>
                                                        </actionsWhenTrue>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                        </analysisRules>
                                    </postProcessing>
                                    <eventHandlers>
                                        <item name="OnRepeatStepMaxCountExceeded">
                                            <item actionId="DeclareExecutionIssue">
                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="Information">
                                                    <message>Unable to set verbosity level</message>
                                                </actionProperties>
                                            </item>
                                        </item>
                                    </eventHandlers>
                                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties">
                                        <promptProperties>
                                            <stepPrompts>
                                                <item name="Select" MatchMethod="REGULAR_EXPRESSION">
                                                    <Content>\\s+Select:</Content>
                                                </item>
                                                <item name="MonSubMenu" MatchMethod="WILDCARD" TypeOfPrompt="PASSWORD">
                                                    <Content>*&lt;ENTER&gt; Re-Display Options*</Content>
                                                </item>
                                            </stepPrompts>
                                            <alsoUseSessionPrompts inherit="false">false</alsoUseSessionPrompts>
                                        </promptProperties>
                                        <completionProperties>
                                            <idleChannel inherit="false">200</idleChannel>
                                            <completeWhen inherit="false">AUTO_OR_IDLE</completeWhen>
                                            <promptExtraction inherit="false">ANYWHERE</promptExtraction>
                                            <screenMode inherit="false" defaultValue=""/>
                                        </completionProperties>
                                    </applicationProperties>
                                    <responseMap>project://d_Cisco_ASR5K/response_maps/MonSubVerbosity.ffrm</responseMap>
                                    <useResponseMapLibraryFromSession>false</useResponseMapLibraryFromSession>
                                </item>
                                <item guid="3ab8c3de-cd64-4bf4-9aca-f8bbc73c9b0a" action="command" session="$session" normalOffset="0.358">
                                    <command>
                                        <body>+</body>
                                    </command>
                                    <eventHandlers>
                                        <item name="OnPromptNotFoundTimeout">
                                            <item actionId="DeclareExecutionIssue">
                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                    <message>Step timed out waiting for the prompt</message>
                                                </actionProperties>
                                            </item>
                                            <item actionId="FailTest">
                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                            </item>
                                        </item>
                                    </eventHandlers>
                                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties">
                                        <promptProperties>
                                            <stepPrompts>
                                                <item name="Select" MatchMethod="REGULAR_EXPRESSION">
                                                    <Content>\\s+Select:</Content>
                                                </item>
                                                <item name="MonSubMenu" MatchMethod="WILDCARD" TypeOfPrompt="PASSWORD">
                                                    <Content>*&lt;ENTER&gt; Re-Display Options*</Content>
                                                </item>
                                            </stepPrompts>
                                            <alsoUseSessionPrompts inherit="false">false</alsoUseSessionPrompts>
                                        </promptProperties>
                                        <completionProperties>
                                            <idleChannel inherit="false">200</idleChannel>
                                            <completeWhen inherit="false">AUTO_OR_IDLE</completeWhen>
                                            <promptExtraction inherit="false">ANYWHERE</promptExtraction>
                                            <screenMode inherit="false" defaultValue=""/>
                                        </completionProperties>
                                    </applicationProperties>
                                    <responseMap>project://d_SPGW/response_maps/monSubMenu.ffrm</responseMap>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                            <useFieldsInCommand>false</useFieldsInCommand>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                    <useFieldsInCommand>false</useFieldsInCommand>
                </item>
                <item guid="12f3b445-0158-4c69-a1c8-dd162523e30f" action="comment">
                    <command>
                        <body>For each protocol to be enabled, check the response and see if it is already enabled. The response is a multi-column table so we need to check each column to find the protocol. Once found, we skip the remainder of the columns.</body>
                    </command>
                    <nestedSteps>
                        <item guid="d659dd8b-a00c-4d54-9ec9-d83fe530502b" action="foreach">
                            <command>
                                <body>protocol $protocol_layers</body>
                            </command>
                            <nestedSteps>
                                <item guid="05f406d0-0861-45f5-ab8e-a1ef8f0a9094" action="command" session="$session" normalOffset="0.358" useResponseMapLibraryApplicability="false">
                                    <command>
                                        <body>\\n</body>
                                    </command>
                                    <postProcessing>
                                        <analysisRules>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup" declareNoMatchIssue="false">
                                                        <query sub="true">col1_value_by_index(&quot;$protocol&quot;)</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="assert">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                        <expression>$value eq &quot;ON&quot;</expression>
                                                        <actionsWhenTrue>
                                                            <item actionId="Continue">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                        </actionsWhenTrue>
                                                        <actionsWhenFalse>
                                                            <item actionId="SkipRemainingRules">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                        </actionsWhenFalse>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup" declareNoMatchIssue="false">
                                                        <query sub="true">col2_value_by_index(&quot;$protocol&quot;)</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="assert">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                        <expression>$value eq &quot;ON&quot;</expression>
                                                        <actionsWhenTrue>
                                                            <item actionId="Continue">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                        </actionsWhenTrue>
                                                        <actionsWhenFalse>
                                                            <item actionId="SkipRemainingRules">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                        </actionsWhenFalse>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup" declareNoMatchIssue="false">
                                                        <query sub="true">col3_value_by_index(&quot;$protocol&quot;)</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="assert">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                        <expression>$value eq &quot;ON&quot;</expression>
                                                        <actionsWhenTrue>
                                                            <item actionId="Continue">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                        </actionsWhenTrue>
                                                        <actionsWhenFalse>
                                                            <item actionId="SkipRemainingRules">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                        </actionsWhenFalse>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                        </analysisRules>
                                    </postProcessing>
                                    <eventHandlers>
                                        <item name="OnResponseMappingIssue"/>
                                        <item name="OnMappingFail"/>
                                        <item name="OnPromptNotFoundTimeout">
                                            <item actionId="RepeatStep">
                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.RepeatStepPropertyGroup" maxRepeatCount="3"/>
                                            </item>
                                        </item>
                                    </eventHandlers>
                                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties">
                                        <promptProperties>
                                            <stepPrompts>
                                                <item name="Select" MatchMethod="REGULAR_EXPRESSION">
                                                    <Content>\\s+Select:</Content>
                                                </item>
                                                <item name="MonSubMenu" MatchMethod="WILDCARD" TypeOfPrompt="PASSWORD">
                                                    <Content>*&lt;ENTER&gt; Re-Display Options*</Content>
                                                </item>
                                            </stepPrompts>
                                            <alsoUseSessionPrompts inherit="false">false</alsoUseSessionPrompts>
                                        </promptProperties>
                                        <completionProperties>
                                            <idleChannel inherit="false">200</idleChannel>
                                            <completeWhen inherit="false">AUTO_OR_IDLE</completeWhen>
                                            <promptExtraction inherit="false">ANYWHERE</promptExtraction>
                                            <screenMode inherit="false" defaultValue=""/>
                                        </completionProperties>
                                    </applicationProperties>
                                    <responseMap>project://d_Cisco_ASR5K/response_maps/monSubMenu.ffrm</responseMap>
                                    <useResponseMapLibraryFromSession>false</useResponseMapLibraryFromSession>
                                </item>
                                <item guid="d5796a06-a219-4873-b360-5710a4bc9df8" action="comment">
                                    <command>
                                        <body>If we get here, the protocol needs to be enabled</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="3eac25f6-26a0-4708-abfd-25a7a6fb998a" action="command" session="$session" normalOffset="0.358">
                                            <command>
                                                <body>$protocol\\n</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties">
                                                <promptProperties>
                                                    <stepPrompts>
                                                        <item name="Select" MatchMethod="REGULAR_EXPRESSION">
                                                            <Content>\\s+Select:</Content>
                                                        </item>
                                                        <item name="MonSubMenu" MatchMethod="WILDCARD" TypeOfPrompt="PASSWORD">
                                                            <Content>*&lt;ENTER&gt; Re-Display Options*</Content>
                                                        </item>
                                                    </stepPrompts>
                                                    <alsoUseSessionPrompts inherit="false">false</alsoUseSessionPrompts>
                                                </promptProperties>
                                                <completionProperties>
                                                    <idleChannel inherit="false">200</idleChannel>
                                                    <completeWhen inherit="false">AUTO_OR_IDLE</completeWhen>
                                                    <promptExtraction inherit="false">ANYWHERE</promptExtraction>
                                                    <completionTime inherit="false">1</completionTime>
                                                    <screenMode inherit="false" defaultValue=""/>
                                                </completionProperties>
                                            </applicationProperties>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                    <useFieldsInCommand>false</useFieldsInCommand>
                                </item>
                                <item guid="3fa30cb3-01b6-41f0-8d6e-cf5d5add905e" action="command" session="$session" normalOffset="0.358" useResponseMapLibraryApplicability="false">
                                    <command>
                                        <body>\\n</body>
                                    </command>
                                    <eventHandlers>
                                        <item name="OnResponseMappingIssue"/>
                                        <item name="OnMappingFail"/>
                                        <item name="OnPromptNotFoundTimeout">
                                            <item actionId="RepeatStep">
                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.RepeatStepPropertyGroup" maxRepeatCount="3"/>
                                            </item>
                                        </item>
                                    </eventHandlers>
                                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties">
                                        <promptProperties>
                                            <stepPrompts>
                                                <item name="Select" MatchMethod="REGULAR_EXPRESSION">
                                                    <Content>\\s+Select:</Content>
                                                </item>
                                                <item name="MonSubMenu" MatchMethod="WILDCARD" TypeOfPrompt="PASSWORD">
                                                    <Content>*&lt;ENTER&gt; Re-Display Options*</Content>
                                                </item>
                                            </stepPrompts>
                                            <alsoUseSessionPrompts inherit="false">false</alsoUseSessionPrompts>
                                        </promptProperties>
                                        <completionProperties>
                                            <idleChannel inherit="false">200</idleChannel>
                                            <completeWhen inherit="false">AUTO_OR_IDLE</completeWhen>
                                            <promptExtraction inherit="false">ANYWHERE</promptExtraction>
                                            <screenMode inherit="false" defaultValue=""/>
                                        </completionProperties>
                                    </applicationProperties>
                                    <responseMap>project://d_Cisco_ASR5K/response_maps/monSubMenu.ffrm</responseMap>
                                    <useResponseMapLibraryFromSession>false</useResponseMapLibraryFromSession>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                            <useFieldsInCommand>false</useFieldsInCommand>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                    <useFieldsInCommand>false</useFieldsInCommand>
                </item>
                <item guid="fe9a90b7-d9a3-4bca-b4df-293afb41a201" action="comment">
                    <command>
                        <body>Monitor Subscriber is finished configuring</body>
                    </command>
                    <nestedSteps>
                        <item guid="e31ee91e-7c52-4aa0-a4f9-798c030f37fe" action="signal">
                            <command>
                                <body>monSubConfigured</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                    <useFieldsInCommand>false</useFieldsInCommand>
                </item>
            </steps>
            <multilineDescription>Start a monitor subscriber session 

NOTE: Monitor Subscriber Never returns so this should be started in a thread and signalled by the main test case or a Fake Prompt should be passed to this procedure.

Return Value: JSON Block
status: 1 - success; 0 - failure</multilineDescription>
            <arguments>
                <item name="IMEI">
                    <description>If pased, this procedure will filter on this IMEI</description>
                </item>
                <item name="IMSI">
                    <description>If pased, this procedure will filter on this IMSI</description>
                </item>
                <item name="verbosity_level">
                    <description>The verbosity level to select: iTest will hit theh &quot;+&quot; the specified number of times</description>
                    <defaultValue>5</defaultValue>
                </item>
                <item name="protocol_layers">
                    <defaultValue>81 82 74 70 29 </defaultValue>
                </item>
                <item name="fakePrompt">
                    <description>If passed, iTest will look to terminate the Mon Sub when this text is found</description>
                </item>
                <item name="captureTime">
                    <description>The time to capture monSub in seconds</description>
                    <defaultValue>120</defaultValue>
                </item>
            </arguments>
            <response>{&quot;success&quot;:&quot;1&quot;}</response>
        </item>
        <item name="signalWaitCleanupLogging" isPublic="true" isVBlock="true">
            <steps>
                <item guid="71200ef7-1a29-4dce-9e3c-ce4c3bb1757e" action="signalWait">
                    <command>
                        <body>Cleanup</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="11c5f35c-b1e7-4a62-86dd-0fabedb9f444" action="disableLogging" session="$session">
                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties"/>
                    <useFieldsInCommand>false</useFieldsInCommand>
                </item>
            </steps>
            <multilineDescription>Cleanup logging for a session when the &quot;Cleanup&quot; signal is activated.

This procedure is designed to run in a thread.

Return Value: Block
success: 0 - failure; 1 - success
</multilineDescription>
            <response>{&quot;success&quot;:&quot;1&quot;}</response>
        </item>
        <item name="showLogs" isPublic="true">
            <description>Show syslog</description>
            <steps>
                <item guid="6ea44204-ba90-48ee-9cbc-f6f4bf8f6224" action="command" session="$session">
                    <command>
                        <body>show logs since $timestamp</body>
                    </command>
                    <postProcessing>
                        <analysisRules>
                            <item>
                                <extractorInfo extractorType="regex">
                                    <extractorProperties type="com.fnfr.svt.mapping.regex.extractors.RegexExtractorPropertyGroup">
                                        <regex>(.+)</regex>
                                    </extractorProperties>
                                </extractorInfo>
                                <processorInfo ruleType="assert">
                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                        <expression>1</expression>
                                        <actionsWhenTrue>
                                            <item actionId="AppendToProcedureResponse">
                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.AppendResponsePropertyGroup">
                                                    <content sub="true">$value</content>
                                                </actionProperties>
                                            </item>
                                        </actionsWhenTrue>
                                    </ruleProperties>
                                </processorInfo>
                            </item>
                        </analysisRules>
                    </postProcessing>
                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties"/>
                </item>
            </steps>
            <author>Malcom Terry</author>
            <multilineDescription>Returns the logs since the timestamp value passed.

Return Value:
List of logs</multilineDescription>
            <arguments>
                <item name="timestamp">
                    <description>Get logs since &lt;timestamp&gt;

timestamp format:
YYYY:MM:DD:hh:mm:ss</description>
                    <isMandatory>true</isMandatory>
                </item>
            </arguments>
        </item>
        <item name="showSubscriber" isPublic="true" isVBlock="true">
            <responseMap>project://d_Cisco_ASR5K/response_maps/JsonBlockToQueries.ffrm</responseMap>
            <steps>
                <item guid="47e3df1a-26b7-4a48-9c08-f913998b04f9" action="comment">
                    <command>
                        <body>If the &quot;full&quot; flag is set, add &quot;full&quot; to the show subscriber command</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                    <useFieldsInCommand>false</useFieldsInCommand>
                </item>
                <item guid="ccca3c0a-2d55-41fd-b5f1-0b34fc4ee1a3" action="if">
                    <command>
                        <body>$full &gt; 0</body>
                    </command>
                    <nestedSteps>
                        <item guid="b3cd5e19-6fef-46bb-9f1b-bb44eaeeafda" action="then">
                            <nestedSteps>
                                <item guid="b989ff28-7a80-4018-8f23-675655e1c098" action="command" session="$session">
                                    <command>
                                        <body>show subscriber full imsi $IMSI</body>
                                    </command>
                                    <postProcessing>
                                        <analysisRules>
                                            <item>
                                                <extractorInfo extractorType="regex">
                                                    <extractorProperties type="com.fnfr.svt.mapping.regex.extractors.RegexExtractorPropertyGroup">
                                                        <regex>(.+)</regex>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="assert">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                        <expression>[string match &quot;*No subscribers match*&quot; $value]</expression>
                                                        <actionsWhenTrue>
                                                            <item actionId="SkipRemainingRules">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                        </actionsWhenTrue>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup" declareNoMatchIssue="false">
                                                        <query>Username()</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="store">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                        <query>[return username]</query>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup" declareNoMatchIssue="false">
                                                        <query>(.//ip_address)[1]</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="store">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                        <query>[return ip_address]</query>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                        </analysisRules>
                                    </postProcessing>
                                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                            <useFieldsInCommand>false</useFieldsInCommand>
                        </item>
                        <item guid="0903f08f-4b04-487d-b6ed-6d618016dd3f" action="else">
                            <nestedSteps>
                                <item guid="e29054d9-06d8-482e-9baa-d6f45ad9af58" action="command" session="$session">
                                    <command>
                                        <body>show subscriber imsi $IMSI</body>
                                    </command>
                                    <postProcessing>
                                        <analysisRules>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup" declareNoMatchIssue="false">
                                                        <query>(mapped/Tabular/table1/table/row/Username)[1]</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="store">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                        <query>[return username]</query>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup" declareNoMatchIssue="false">
                                                        <query>(mapped/Tabular/table1/table/row/IP)[1]</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="store">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                        <query>[return ip_address]</query>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup" declareNoMatchIssue="false">
                                                        <query>(mapped/Tabular/table1/table/row/IP)[2]</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="store">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                        <query>[return ip_address2]</query>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                        </analysisRules>
                                    </postProcessing>
                                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                            <useFieldsInCommand>false</useFieldsInCommand>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                    <useFieldsInCommand>false</useFieldsInCommand>
                </item>
            </steps>
            <multilineDescription>Get subscriber information for the specified IMSI</multilineDescription>
            <arguments>
                <item name="IMSI">
                    <description>The IMSI values</description>
                    <isMandatory>true</isMandatory>
                </item>
                <item name="full">
                    <description>1 - show subscriber full imsi; 0 - show subscriber imsi</description>
                    <defaultValue>0</defaultValue>
                </item>
            </arguments>
            <response>{&quot;username&quot;:&quot;0&quot;,&quot;ip_address&quot;:&quot;0&quot;,&quot;ip_address2&quot;:&quot;0&quot;}</response>
        </item>
        <item name="showSubscriberAll" isPublic="true">
            <responseMap>project://d_Cisco_ASR5K/response_maps/show_subscriber_imsi.ffrm</responseMap>
            <steps>
                <item guid="62e161d6-b1b9-42fe-802f-c480b4125898" action="command" session="$session" useResponseMapLibraryApplicability="false">
                    <command>
                        <body>show subscriber all</body>
                    </command>
                    <postProcessing>
                        <analysisRules>
                            <item>
                                <extractorInfo extractorType="regex">
                                    <extractorProperties type="com.fnfr.svt.mapping.regex.extractors.RegexExtractorPropertyGroup">
                                        <regex>(.+)</regex>
                                    </extractorProperties>
                                </extractorInfo>
                                <processorInfo ruleType="assert">
                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                        <expression>1</expression>
                                        <actionsWhenTrue>
                                            <item actionId="AppendToProcedureResponse">
                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.AppendResponsePropertyGroup">
                                                    <content sub="true">$value</content>
                                                </actionProperties>
                                            </item>
                                        </actionsWhenTrue>
                                    </ruleProperties>
                                </processorInfo>
                            </item>
                        </analysisRules>
                    </postProcessing>
                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties"/>
                    <responseMap>project://d_Cisco_ASR5K/response_maps/show_subscriber_imsi.ffrm</responseMap>
                    <useResponseMapLibraryFromSession>false</useResponseMapLibraryFromSession>
                </item>
            </steps>
        </item>
        <item name="startCapture" isPublic="true" isVBlock="true">
            <responseMap>project://d_Cisco_ASR5K/response_maps/JsonBlockToQueries.ffrm</responseMap>
            <steps>
                <item guid="721666e2-2544-4a53-9ba7-7448ab3c2252" action="comment">
                    <command>
                        <body>Capture for specified number of seconds</body>
                    </command>
                    <nestedSteps>
                        <item guid="20a57268-f53b-490a-a369-590c0cc98a13" action="if">
                            <command>
                                <body>$fakePrompt eq &quot;&quot;</body>
                            </command>
                            <nestedSteps>
                                <item guid="62076177-6755-4846-afe3-607926de3d6f" action="then">
                                    <nestedSteps>
                                        <item guid="a1388d1e-7fb6-48d2-afe5-5fdebc87d2ec" action="command" session="$session">
                                            <command>
                                                <body>\\n</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties">
                                                <completionProperties>
                                                    <completeWhen inherit="false">TIMED</completeWhen>
                                                    <completionTime inherit="false" sub="true">$captureTime</completionTime>
                                                    <screenMode inherit="false" defaultValue=""/>
                                                </completionProperties>
                                            </applicationProperties>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                    <useFieldsInCommand>false</useFieldsInCommand>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                            <useFieldsInCommand>false</useFieldsInCommand>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                    <useFieldsInCommand>false</useFieldsInCommand>
                </item>
                <item guid="73c0ccb3-d848-46ea-bdec-7dad64e22622" action="comment">
                    <command>
                        <body>Wait for &quot;fake&quot; prompt</body>
                    </command>
                    <nestedSteps>
                        <item guid="5bd5ce69-da0b-4fe7-a0bd-bb517c564016" action="if">
                            <command>
                                <body>$fakePrompt ne &quot;&quot;</body>
                            </command>
                            <nestedSteps>
                                <item guid="0cef0d80-9ea5-4f7f-b17a-fa49dc7d9201" action="then">
                                    <nestedSteps>
                                        <item guid="db96627e-bd22-495f-a436-50d953bd4a41" action="command" session="$session">
                                            <command>
                                                <body>\\n</body>
                                            </command>
                                            <eventHandlers>
                                                <item name="OnSessionNotOpen"/>
                                            </eventHandlers>
                                            <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties">
                                                <promptProperties>
                                                    <stepPrompts>
                                                        <item name="FakePrompt">
                                                            <Content sub="true">$fakePrompt</Content>
                                                        </item>
                                                    </stepPrompts>
                                                    <alsoUseSessionPrompts inherit="false">false</alsoUseSessionPrompts>
                                                </promptProperties>
                                                <completionProperties promptLearnUserResponseTime="120" promptLearnUserResponseTime.inherit="false">
                                                    <idleChannel inherit="false" defaultValue=""/>
                                                    <completeWhen inherit="false" defaultValue=""/>
                                                    <promptExtraction inherit="false">ANYWHERE</promptExtraction>
                                                    <maxIdleTimeAddition inherit="false">600.0</maxIdleTimeAddition>
                                                    <completionTime inherit="false">5</completionTime>
                                                    <screenMode inherit="false" defaultValue=""/>
                                                </completionProperties>
                                            </applicationProperties>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                    <useFieldsInCommand>false</useFieldsInCommand>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                            <useFieldsInCommand>false</useFieldsInCommand>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                    <useFieldsInCommand>false</useFieldsInCommand>
                </item>
            </steps>
            <multilineDescription>Send a return and capture for the amount of time specified. This procedure will log autonomous messages such as debug logs, monitor subscriber and monitor protocol</multilineDescription>
            <arguments>
                <item name="captureTime">
                    <description>Send a return and capture for the amount of time specified. </description>
                    <defaultValue>180</defaultValue>
                </item>
                <item name="fakePrompt">
                    <description>If passed, iTest will look to terminate the capture when this text is found</description>
                </item>
            </arguments>
            <response>{&quot;success&quot;:&quot;1&quot;}</response>
        </item>
        <item name="showCallControlProfileName" isPublic="true" isVBlock="true">
            <responseMap>project://d_Cisco_ASR5K/response_maps/JsonBlockToQueries.ffrm</responseMap>
            <steps>
                <item guid="8cd9d79c-4cf1-4a19-99b9-938ae9749e06" action="command" session="$session">
                    <command>
                        <body>show call-control-profile full name $cc_profile</body>
                    </command>
                    <postProcessing>
                        <analysisRules>
                            <item>
                                <extractorInfo extractorType="query">
                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                        <query>colValue_by_colName(&quot;PTMSI-Realloc Rau Periodic ANY(UMTS/GPRS) Value&quot;)</query>
                                    </extractorProperties>
                                </extractorInfo>
                                <processorInfo ruleType="store">
                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                        <query>[return frequency]</query>
                                    </ruleProperties>
                                </processorInfo>
                            </item>
                        </analysisRules>
                    </postProcessing>
                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties"/>
                </item>
            </steps>
            <multilineDescription>Check if call control profile is set for PTMSI reallocation frequency every RAU in configuration, if not, attempt to set it.

return: frequency: &gt;0(valid), =0(invalid)</multilineDescription>
            <arguments>
                <item name="cc_profile">
                    <description>The call control profile to be set</description>
                    <isMandatory>true</isMandatory>
                </item>
            </arguments>
            <response>{&quot;frequency&quot;:&quot;0&quot;}</response>
        </item>
        <item name="setPTMISIReallocateFrequency" isPublic="true">
            <steps>
                <item guid="9b6b9ca6-dec9-47d6-a645-2a45392fccc6" action="command" session="$session">
                    <command>
                        <body>config</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties"/>
                </item>
                <item guid="8409ad2d-bc2e-45c5-b902-1d2e943494db" action="command" session="$session">
                    <command>
                        <body>call-control-profile s4sgsn_oper1</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties"/>
                </item>
                <item guid="52f67a72-0ca9-438c-b3da-59e3b185c5f2" action="command" session="$session">
                    <command>
                        <body>ptmsi-reallocate routing-area-update update-type periodic frequency $freq</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties"/>
                </item>
                <item guid="6e69e2a2-a6ad-4f35-9ae0-a06126ba2edb" action="command" session="$session">
                    <command>
                        <body>end</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties"/>
                </item>
                <item guid="75b25e2a-fb84-4406-9530-9270141bdbaa" action="command" session="$session">
                    <command>
                        <body>operator-policy name s4sgsn_oper1</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties"/>
                </item>
                <item guid="6769798a-52bc-40ec-a168-7f299744c14b" action="command" session="$session">
                    <command>
                        <body>description &quot; S4 SGSN Operator Policy&quot;</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties"/>
                </item>
                <item guid="e5f84289-bb0f-42e2-8b28-fe3b3c7cf6f2" action="command" session="$session">
                    <command>
                        <body>associate call-control-profile s4sgsn_oper1</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties"/>
                </item>
                <item guid="91bd475b-aee3-4da0-81e0-bcdd17b63f7d" action="command" session="$session" skip="true">
                    <command>
                        <body>exit</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties"/>
                </item>
            </steps>
            <multilineDescription>Config PTMSI reallocation frequency.

</multilineDescription>
            <arguments>
                <item name="freq">
                    <defaultValue>1</defaultValue>
                    <isMandatory>true</isMandatory>
                </item>
            </arguments>
            <response>{&quot;frequency&quot;:&quot;0&quot;}</response>
        </item>
    </procedures>
</testCase>
